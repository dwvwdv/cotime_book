# ğŸ“š EPUB Home - å…±äº«é–±è®€é«”é©—æ‡‰ç”¨

<div align="center">

**èˆ‡æœ‹å‹ä¸€èµ·é–±è®€ï¼ŒåŒæ­¥ç¿»é ï¼Œå…±äº«é«”é©—**

![Flutter](https://img.shields.io/badge/Flutter-3.32.0-02569B?logo=flutter)
![Dart](https://img.shields.io/badge/Dart-3.3+-0175C2?logo=dart)
![License](https://img.shields.io/badge/License-MIT-green)

</div>

## âœ¨ åŠŸèƒ½äº®é»

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

1. **ğŸ“– å®Œæ•´çš„ EPUB é–±è®€å™¨**
   - æ”¯æ´æ¨™æº– EPUB æ ¼å¼
   - HTML å…§å®¹å®Œç¾æ¸²æŸ“
   - ç« ç¯€å°èˆªèˆ‡é€²åº¦è¿½è¹¤
   - æµæš¢çš„é–±è®€é«”é©—

2. **ğŸ‘¥ å¤šäººæˆ¿é–“é€£ç·š**
   - æœ¬åœ°ç¶²çµ¡è¨­å‚™è‡ªå‹•ç™¼ç¾ï¼ˆmDNSï¼‰
   - å¿«é€Ÿå‰µå»º/åŠ å…¥é–±è®€æˆ¿é–“
   - å¯¦æ™‚åƒèˆ‡è€…ç‹€æ…‹é¡¯ç¤º
   - æˆ¿ä¸»æ¬Šé™ç®¡ç†

3. **ğŸ”„ åŒæ­¥ç¿»é æ©Ÿåˆ¶**
   - æ™ºèƒ½ç­‰å¾…æ‰€æœ‰åƒèˆ‡è€…ç¢ºèª
   - Webhook é›†æˆï¼ˆn8nï¼‰å¯¦ç¾å”èª¿
   - è¦–è¦ºåŒ–ç­‰å¾…ç‹€æ…‹
   - ä¸€éµå–æ¶ˆç¿»é è«‹æ±‚

### ğŸ¨ ä½¿ç”¨å ´æ™¯

**èˆ‡æœ‹å‹å…±åŒé–±è®€ä¸€æœ¬æ›¸**
```
1. æˆ¿ä¸»é¸æ“‡æ›¸ç±ä¸¦å‰µå»ºæˆ¿é–“
2. æœ‹å‹é€šéæœ¬åœ°ç¶²çµ¡åŠ å…¥æˆ¿é–“
3. ä»»ä½•äººæƒ³ç¿»é æ™‚é»æ“Š
4. ç³»çµ±ç­‰å¾…æ‰€æœ‰äººç¢ºèª
5. ç¢ºèªå®Œæˆå¾Œï¼Œæ‰€æœ‰è¨­å‚™åŒæ­¥ç¿»é 
6. äº«å—åŒæ­¥é–±è®€çš„æ¨‚è¶£
```

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### æŠ€è¡“æ£§

| å±¤æ¬¡ | æŠ€è¡“é¸å‹ | èªªæ˜ |
|------|---------|------|
| **UI æ¡†æ¶** | Flutter 3.32.0 | è·¨å¹³å°ç§»å‹•æ‡‰ç”¨é–‹ç™¼ |
| **ç‹€æ…‹ç®¡ç†** | Provider + GetIt | å…¨å±€ç‹€æ…‹ç®¡ç†èˆ‡ä¾è³´æ³¨å…¥ |
| **EPUB è§£æ** | epubx | EPUB æ–‡ä»¶è§£æèˆ‡å…§å®¹æå– |
| **HTML æ¸²æŸ“** | flutter_html | å¯Œæ–‡æœ¬å…§å®¹é¡¯ç¤º |
| **ç¶²çµ¡é€šä¿¡** | Dio + HTTP | RESTful API èˆ‡ Webhook |
| **æœ¬åœ°ç™¼ç¾** | multicast_dns | mDNS è¨­å‚™ç™¼ç¾ |
| **æœ¬åœ°å­˜å„²** | SharedPreferences + SQLite | é…ç½®èˆ‡æ•¸æ“šæŒä¹…åŒ– |

### æ¶æ§‹è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Presentation Layer             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Screens  â”‚ Widgets  â”‚Provider â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Business Logic Layer           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  EPUB    â”‚  Room    â”‚  Sync   â”‚ â”‚
â”‚  â”‚ Service  â”‚ Service  â”‚ Service â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Data Layer                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Models  â”‚ Storage  â”‚ Network â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åŒæ­¥æ©Ÿåˆ¶

```mermaid
sequenceDiagram
    participant User A
    participant App A
    participant n8n Webhook
    participant App B
    participant User B

    User A->>App A: é»æ“Šç¿»é 
    App A->>n8n Webhook: POST /webhook/{roomKey}
    App A->>App A: ç‹€æ…‹: waiting

    User B->>App B: é»æ“Šç¿»é 
    App B->>n8n Webhook: POST /webhook/{roomKey}
    App B->>App B: ç‹€æ…‹: waiting

    n8n Webhook->>n8n Webhook: æª¢æŸ¥æ‰€æœ‰äººå·²ç¢ºèª
    n8n Webhook-->>App A: 200 OK (ready)
    n8n Webhook-->>App B: 200 OK (ready)

    App A->>App A: åŸ·è¡Œç¿»é 
    App B->>App B: åŸ·è¡Œç¿»é 
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ç’°å¢ƒè¦æ±‚

- Flutter SDK: 3.32.0+
- Dart SDK: 3.3+
- Android SDK: API 21+
- Java: 17+

### å®‰è£æ­¥é©Ÿ

1. **å…‹éš†é …ç›®**
```bash
git clone <repository-url>
cd epub_home
```

2. **å®‰è£ä¾è³´**
```bash
flutter pub get
```

3. **é‹è¡Œæ‡‰ç”¨**
```bash
# é–‹ç™¼æ¨¡å¼
flutter run

# ç”Ÿç”¢æ¨¡å¼
flutter run --release
```

4. **æ§‹å»º APK**
```bash
flutter build apk --release
```

### é…ç½® n8n Webhook

1. åœ¨ n8n ä¸­å‰µå»º Webhook ç¯€é»
2. è¨­ç½® URL: `https://n8n.lazyrhythm.com/webhook/{roomKey}`
3. é…ç½®é‚è¼¯ï¼š
   - æ¥æ”¶æ‰€æœ‰ç”¨æˆ¶çš„ç¿»é è«‹æ±‚
   - è¿½è¹¤æ¯å€‹æˆ¿é–“çš„ç¢ºèªç‹€æ…‹
   - ç•¶æ‰€æœ‰äººç¢ºèªå¾Œè¿”å› 200 OK
   - æœªå®Œæˆæ™‚è¿”å› 202 Accepted

## ğŸ“± ä½¿ç”¨æŒ‡å—

### å°å…¥æ›¸ç±

1. é»æ“Šã€Œæ›¸åº«ã€æ¨™ç±¤
2. é»æ“Šã€Œå°å…¥ EPUBã€æŒ‰éˆ•
3. é¸æ“‡ EPUB æ–‡ä»¶
4. ç­‰å¾…è§£æå®Œæˆ

### å‰µå»ºæˆ¿é–“

1. é»æ“Šã€Œæˆ¿é–“ã€æ¨™ç±¤
2. é»æ“Šã€Œå‰µå»ºæˆ¿é–“ã€æŒ‰éˆ•
3. è¼¸å…¥æˆ¿é–“åç¨±
4. é¸æ“‡è¦å…±äº«çš„æ›¸ç±
5. é»æ“Šã€Œå‰µå»ºã€

### åŠ å…¥æˆ¿é–“

1. ç¢ºä¿åœ¨åŒä¸€ç¶²çµ¡
2. ç­‰å¾…è‡ªå‹•ç™¼ç¾
3. é¸æ“‡è¦åŠ å…¥çš„æˆ¿é–“
4. é–‹å§‹åŒæ­¥é–±è®€

### åŒæ­¥é–±è®€

1. åœ¨é–±è®€é é¢ï¼Œé»æ“Šå±å¹•å³å´ç¿»é 
2. ç­‰å¾…å…¶ä»–åƒèˆ‡è€…ç¢ºèª
3. æ‰€æœ‰äººç¢ºèªå¾Œè‡ªå‹•ç¿»é 
4. å¯éš¨æ™‚å–æ¶ˆç¿»é è«‹æ±‚

## ğŸ“‚ é …ç›®çµæ§‹

```
lib/
â”œâ”€â”€ main.dart                 # æ‡‰ç”¨å…¥å£
â”œâ”€â”€ app.dart                  # App é…ç½®
â”œâ”€â”€ models/                   # æ•¸æ“šæ¨¡å‹
â”‚   â”œâ”€â”€ book.dart            # æ›¸ç±æ¨¡å‹
â”‚   â”œâ”€â”€ room.dart            # æˆ¿é–“æ¨¡å‹
â”‚   â””â”€â”€ user.dart            # ç”¨æˆ¶æ¨¡å‹
â”œâ”€â”€ services/                 # æœå‹™å±¤
â”‚   â”œâ”€â”€ epub_service.dart    # EPUB è§£æ
â”‚   â”œâ”€â”€ room_service.dart    # æˆ¿é–“ç®¡ç†
â”‚   â”œâ”€â”€ sync_service.dart    # åŒæ­¥æœå‹™
â”‚   â”œâ”€â”€ storage_service.dart # æœ¬åœ°å­˜å„²
â”‚   â””â”€â”€ network_service.dart # ç¶²çµ¡æœå‹™
â”œâ”€â”€ providers/                # ç‹€æ…‹ç®¡ç†
â”‚   â”œâ”€â”€ book_provider.dart   # æ›¸ç±ç‹€æ…‹
â”‚   â”œâ”€â”€ room_provider.dart   # æˆ¿é–“ç‹€æ…‹
â”‚   â””â”€â”€ user_provider.dart   # ç”¨æˆ¶ç‹€æ…‹
â”œâ”€â”€ screens/                  # ç•«é¢
â”‚   â”œâ”€â”€ home_screen.dart     # é¦–é 
â”‚   â”œâ”€â”€ library_screen.dart  # æ›¸åº«
â”‚   â”œâ”€â”€ reader_screen.dart   # é–±è®€å™¨
â”‚   â””â”€â”€ room_screen.dart     # æˆ¿é–“ç®¡ç†
â”œâ”€â”€ widgets/                  # è‡ªå®šç¾©çµ„ä»¶
â”‚   â”œâ”€â”€ epub_reader.dart     # EPUB é–±è®€å™¨
â”‚   â””â”€â”€ page_turn_overlay.dart # ç¿»é ç­‰å¾…è¦†è“‹å±¤
â””â”€â”€ utils/                    # å·¥å…·é¡
    â”œâ”€â”€ constants.dart       # å¸¸é‡
    â””â”€â”€ di.dart              # ä¾è³´æ³¨å…¥
```

## ğŸ”§ æ ¸å¿ƒä¾è³´

```yaml
dependencies:
  # EPUB è§£æ
  epubx: ^4.0.0
  flutter_html: ^3.0.0-beta.2

  # ç¶²çµ¡
  dio: ^5.4.0
  http: ^1.2.0

  # æœ¬åœ°ç¶²çµ¡ç™¼ç¾
  multicast_dns: ^0.3.2
  network_info_plus: ^5.0.0

  # ç‹€æ…‹ç®¡ç†
  provider: ^6.1.1
  get_it: ^7.6.7

  # å­˜å„²
  shared_preferences: ^2.2.2
  sqflite: ^2.3.2

  # UI
  file_picker: ^6.1.1
  qr_flutter: ^4.1.0
```

## ğŸ¯ é–‹ç™¼è¨ˆåŠƒ

### âœ… å·²å®Œæˆ
- [x] EPUB é–±è®€å™¨æ ¸å¿ƒåŠŸèƒ½
- [x] æˆ¿é–“å‰µå»ºèˆ‡ç®¡ç†
- [x] æœ¬åœ°ç¶²çµ¡è¨­å‚™ç™¼ç¾
- [x] åŒæ­¥ç¿»é æ©Ÿåˆ¶
- [x] Webhook é›†æˆ

### ğŸš§ é€²è¡Œä¸­
- [ ] å®Œå–„ UI/UX è¨­è¨ˆ
- [ ] æ·»åŠ å–®å…ƒæ¸¬è©¦
- [ ] æ€§èƒ½å„ªåŒ–

### ğŸ“‹ æœªä¾†è¨ˆåŠƒ
- [ ] **å¤–éƒ¨ç¶²çµ¡é€£ç·šæ”¯æ´**
  - WebSocket å¯¦æ™‚é€šä¿¡
  - é›²ç«¯æˆ¿é–“ç®¡ç†
  - NAT ç©¿é€æŠ€è¡“

- [ ] **é–±è®€åŠŸèƒ½å¢å¼·**
  - æ›¸ç±¤ç®¡ç†
  - ç­†è¨˜èˆ‡æ¨™è¨»
  - å­—é«”å¤§å°èª¿æ•´
  - å¤œé–“æ¨¡å¼
  - èƒŒæ™¯é¡è‰²è‡ªå®šç¾©

- [ ] **ç¤¾äº¤åŠŸèƒ½**
  - æˆ¿é–“å…§èªéŸ³èŠå¤©
  - å³æ™‚æ–‡å­—è¨Šæ¯
  - é–±è®€çµ±è¨ˆèˆ‡æˆå°±
  - åˆ†äº«è®€æ›¸å¿ƒå¾—

- [ ] **æ€§èƒ½å„ªåŒ–**
  - ç« ç¯€é åŠ è¼‰
  - åœ–ç‰‡ç·©å­˜æ©Ÿåˆ¶
  - é›¢ç·šé–±è®€æ”¯æ´
  - å¢é‡æ›´æ–°

## ğŸ¤ è²¢ç»æŒ‡å—

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork é …ç›®
2. å‰µå»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. é–‹å•Ÿ Pull Request

## ğŸ“„ è¨±å¯è­‰

æœ¬é …ç›®æ¡ç”¨ MIT è¨±å¯è­‰ - è©³è¦‹ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ‘¨â€ğŸ’» ä½œè€…

**LazyRhythm Team**

- GitHub: [@lazyrhythm](https://github.com/lazyrhythm)
- n8n Webhook: https://n8n.lazyrhythm.com

## ğŸ™ è‡´è¬

- Flutter Team - å„ªç§€çš„è·¨å¹³å°æ¡†æ¶
- epubx - EPUB è§£æåº«
- flutter_html - HTML æ¸²æŸ“æ”¯æ´
- æ‰€æœ‰é–‹æºè²¢ç»è€…

---

<div align="center">
Made with â¤ï¸ by LazyRhythm Team
</div>
